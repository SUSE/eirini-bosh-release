<%
    # Takes a string and returns a base64 encoded string
    # 'm' says base64 and the '0' means do not add newlines.
    def encode64(bin)
      [bin].pack("m0")
    end
%>
apiVersion: v1
kind: Secret
metadata:
  name: <%= p("opi.certs_secret_name") %>
type: Opaque
data:
  cc-server-crt: <%= encode64(p("cc.server_cert")) %>
  cc-server-crt-key: <%= encode64(p("cc.server_cert_key")) %>
  cc-uploader-crt: <%= encode64(p("cc.server_cert")) %>
  cc-uploader-crt-key: <%= encode64(p("cc.server_cert_key")) %>
  internal-ca-cert: <%= encode64(p("cc.ca_cert")) %>
  eirini-client-crt: <%= encode64(p("eirini.server_cert")) %>
  eirini-client-crt-key: <%= encode64(p("eirini.server_key")) %>
